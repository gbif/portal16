/* eslint-disable object-curly-spacing */
/*
Similate approximate load on services for the new demo site when visiting a dataset page.
*/
const { graphqlRequest, replaceKeyInVariables } = require('./graphqlRequest');

const exampleKey = '5000621882';

function occurrenceKeyLoad(occurrenceKey) {
  graphqlRequest(queries.details.query, { key: occurrenceKey });
  graphqlRequest(queries.slow.query, replaceKeyInVariables(queries.slow.variables, exampleKey, occurrenceKey));
  graphqlRequest(queries.eventId.query, replaceKeyInVariables(queries.eventId.variables, 'randomId', Math.random().toString(36).substring(2, 8)));
}

const queries = {
  details: { 'query': '\n  query Occurrence($key: ID!) {\n    occurrence(key: $key) {\n      key\n      coordinates\n      organismName\n      lastCrawled\n      countryCode\n      stateProvince\n      locality\n      eventDate\n      typeStatus\n      references\n      issues\n      basisOfRecord\n      dynamicProperties\n      institutionKey\n      collectionKey\n      isInCluster\n      volatile {\n        globe(sphere: false, land: false, graticule: false) {\n          svg\n          lat\n          lon\n        }\n        features {\n          isSpecimen\n          isTreament\n          isSequenced\n          isClustered\n          isSamplingEvent\n          firstIIIF\n        }\n      }\n      datasetKey\n      datasetTitle\n      publishingOrgKey\n      publisherTitle\n      dataset {\n        citation {\n          text\n        }\n      }\n      institutionCode\n\n      extensions {\n        audubon\n        amplification\n        germplasmAccession\n        germplasmMeasurementScore\n        germplasmMeasurementTrait\n        germplasmMeasurementTrial\n        identification\n        identifier\n        image\n        measurementOrFact\n        multimedia\n        reference\n        eolReference\n        resourceRelationship\n        cloning\n        gelImage\n        loan\n        materialSample\n        permit\n        preparation\n        preservation\n        extendedMeasurementOrFact\n        chronometricAge\n        dnaDerivedData\n      }\n\n      gadm\n\n      stillImageCount\n      movingImageCount\n      soundCount\n      stillImages {\n        ...OccurrenceMediaDetails\n      }\n      sounds {\n        ...OccurrenceMediaDetails\n      }\n      movingImages {\n        ...OccurrenceMediaDetails\n      }\n\n      verbatimScientificName\n      classifications {\n        meta {\n          mainIndex {\n            datasetKey: clbDatasetKey\n            datasetTitle\n          }\n        }\n        checklistKey\n        usage {\n          rank\n          name\n          key\n        }\n        acceptedUsage {\n          key\n          name\n        }\n        taxonMatch {\n          usage {\n            name\n            key\n            canonicalName\n            formattedName\n          }\n          synonym\n        }\n        classification {\n          key\n          rank\n          name\n        }\n        issues\n      }\n      primaryImage {\n        identifier\n      }\n      terms {\n        ...OccurrenceTerm\n      }\n      scientificName\n      recordedByIDs {\n        type\n        value\n      }\n      identifiedByIDs {\n        type\n        value\n      }\n    }\n  }\n\n  fragment OccurrenceMediaDetails on MultimediaItem {\n    title\n    type\n    format\n    identifier\n    created\n    creator\n    license\n    publisher\n    references\n    rightsHolder\n    description\n    thumbor(height: 800)\n  }\n\n  fragment OccurrenceTerm on Term {\n    simpleName\n    verbatim\n    value\n    htmlValue\n    remarks\n    issues\n  }\n', 'variables': { 'key': '5000621882' }, 'operationName': 'Occurrence' },
  slow: { 'query': '\n  query SlowOccurrenceKey($key: ID!, $language: String!) {\n    occurrence(key: $key) {\n      key\n      localContexts {\n        project_page\n        title\n        description\n        notes {\n          name(lang: $language)\n          img_url\n          description(lang: $language)\n          pageUrl\n        }\n      }\n      institution {\n        name\n      }\n      collection {\n        name\n      }\n\n      classification {\n        vernacularNames(lang: $language, maxLimit: 1) {\n          name\n          reference {\n            id\n            citation\n          }\n        }\n      }\n    }\n    literatureSearch(gbifOccurrenceKey: [$key]) {\n      documents(size: 100) {\n        results {\n          title\n          abstract\n          authors {\n            firstName\n            lastName\n          }\n          literatureType\n          year\n          identifiers {\n            doi\n          }\n          websites\n        }\n      }\n    }\n  }\n', 'variables': { 'key': '5000621882', 'language': 'eng' }, 'operationName': 'SlowOccurrenceKey' },
  eventId: {'query': '\n  query($predicate: Predicate) {\n    search: occurrenceSearch(predicate: $predicate) {\n      documents {\n        total\n      }\n    }\n  }\n', 'variables': {'predicate': {'type': 'and', 'predicates': [{'type': 'equals', 'key': 'eventId', 'value': 'randomId'}]}}}
};

module.exports = {
  occurrenceKeyLoad
};
